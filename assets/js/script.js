let menuIcon=document.querySelector("#menu-icon"),navbar=document.querySelector(".navbar"),sections=document.querySelectorAll("section"),navLinks=document.querySelectorAll("header nav a");window.onscroll=()=>{sections.forEach(e=>{let t=window.scrollY,o=e.offsetTop-150,r=e.offsetHeight,n=e.getAttribute("id");t>=o&&t<o+r&&navLinks.forEach(e=>{e.classList.remove("active"),document.querySelector("header nav a[href*="+n+"]").classList.add("active")})})},menuIcon.onclick=()=>{menuIcon.classList.toggle("bx-x"),navbar.classList.toggle("active")},emailjs.init("zhgreb4n0uEQKuc1d"),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("contact-form");e?e.addEventListener("submit",function(e){e.preventDefault();let t=e.target;if("undefined"==typeof grecaptcha){Swal.fire({title:"Erro",text:"O Google reCAPTCHA n\xe3o carregou. Verifique sua conex\xe3o.",icon:"error",customClass:{popup:"swal2-popup-custom"}});return}let o=grecaptcha.getResponse();if(!o){Swal.fire({title:"Erro!",text:"Por favor, complete o reCAPTCHA.",icon:"error",width:"450px",padding:"3em",customClass:{popup:"swal2-popup-custom"}});return}if(!t.checkValidity()){Swal.fire({title:"Erro!",text:"Por favor, preencha todos os campos obrigat\xf3rios.",icon:"error",width:"450px",padding:"3em",customClass:{popup:"swal2-popup-custom"}});return}let r=document.createElement("input");r.type="hidden",r.name="g-recaptcha-response",r.value=o,t.appendChild(r),emailjs.sendForm("service_0m8007g","template_qw71pr7",t).then(()=>{Swal.fire({title:"Tudo certo!",text:"Sua mensagem foi enviada com sucesso!",icon:"success",width:"450px",padding:"3em",customClass:{popup:"swal2-popup-custom"}}),t.reset(),grecaptcha.reset(),t.contains(r)&&t.removeChild(r)}).catch(e=>{console.error("Erro EmailJS:",e),t.contains(r)&&t.removeChild(r);let o="Ocorreu um erro ao enviar. Tente novamente.";0===e.status||e.status>=500||e.text&&e.text.includes("Network Error")?o="Nossos servidores de e-mail est\xe3o inst\xe1veis no momento. Por favor, tente mais tarde.":e.text&&e.text.includes("Invalid grant")?o="Houve um erro de valida\xe7\xe3o do reCAPTCHA. Tente novamente.":(e.text&&e.text.includes("reCAPTCHA")||e.text.includes("parameter not found"))&&(o="Erro na comunica\xe7\xe3o com o reCAPTCHA."),Swal.fire({title:"Ops!",text:o,icon:"error",width:"450px",padding:"3em",customClass:{popup:"swal2-popup-custom"}})})}):console.error("Elemento #contact-form n\xe3o encontrado.")});
